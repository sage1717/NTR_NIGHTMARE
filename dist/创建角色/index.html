<head><script type="module">import{createPinia as e}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';var a={667(e,a){a.A=(e,a)=>{const t=e.__vccOpts||e;for(const[e,l]of a)t[e]=l;return t}}},t={};const l=Vue,r={class:'creator-root'},n={key:0,class:'summary-view'},c={class:'summary-grid'},s={class:'summary-label'},d={class:'summary-value'},o={class:'form-view'},i={class:'form-body'},u={class:'form-row'},m={class:'field'},p=['disabled'],f={class:'field field--sm'},v=['disabled'],b={class:'form-row'},V={class:'field field--sm'},N={class:'gender-group'},E=['disabled','onClick'],g={class:'field'},h=['disabled'],k={class:'field field--full'},y=['disabled'],x={class:'field field--full'},w=['disabled'],B={class:'field field--full'},C=['disabled'],D={class:'preset-section'},S={class:'preset-row'},M=['disabled'],T=['value'],U=['disabled'],I=['disabled'],A={class:'preset-row'},F=['disabled'],O=['disabled'],J={class:'form-footer'},L=['disabled'],j={key:0,class:'btn-inner'},R={key:1,class:'btn-inner'},P='starter_character_created',q='tavern_character_presets',G=(0,l.defineComponent)({__name:'App',setup(e){const a=[{label:'男',value:'男'},{label:'女',value:'女'},{label:'扶她',value:'扶她'},{label:'男娘',value:'男娘'}],t=(0,l.ref)({name:'',gender:'',race:'',age:'',appearance:'',traits:'',background:''}),G=(0,l.ref)(!1),H=(0,l.ref)(!1),K=(0,l.ref)([]),Q=(0,l.ref)(''),W=(0,l.ref)('');function X(){const e=W.value.trim();if(!e)return;const a=K.value.findIndex(a=>a.name===e),l={name:e,form:{...t.value}};a>=0?K.value[a]=l:K.value.push(l),localStorage.setItem(q,JSON.stringify(K.value)),Q.value=e,W.value=''}function Y(){const e=K.value.find(e=>e.name===Q.value);e&&(t.value={...e.form})}function Z(){K.value=K.value.filter(e=>e.name!==Q.value),localStorage.setItem(q,JSON.stringify(K.value)),Q.value=''}(0,l.onMounted)(()=>{const e=getVariables({type:'chat'});if(_.get(e,P)){const a=_.get(e,'starter_character_form');a&&(t.value=a),H.value=!0}try{const e=localStorage.getItem(q);K.value=e?JSON.parse(e):[]}catch{K.value=[]}});const ee=(0,l.computed)(()=>{const e=t.value,a={};return e.name&&(a['姓名']=e.name),e.gender&&(a['性别']=e.gender),e.race&&(a['种族']=e.race),e.age&&(a['年龄']=e.age),e.appearance&&(a['外貌']=e.appearance),e.traits&&(a['特质']=e.traits),e.background&&(a['背景故事']=e.background),a});async function ae(){G.value=!0;try{const e=[],a=t.value;e.push('【角色创建】'),e.push(a.name?`姓名：${a.name}`:'姓名：（请随机生成）'),e.push(a.gender?`性别：${a.gender}`:'性别：（请随机生成）'),e.push(a.race?`种族：${a.race}`:'种族：（请随机生成）'),e.push(a.age?`年龄：${a.age}`:'年龄：（请随机生成）'),e.push(a.appearance?`外貌：${a.appearance}`:'外貌：（请随机生成）'),e.push(a.traits?`特质：${a.traits}`:'特质：（请随机生成）'),a.background&&e.push(`背景故事：${a.background}`),e.push(''),e.push('请根据以上信息补全所有「请随机生成」的字段，并以此角色身份开始冒险。');const l=e.join('\n');replaceVariables({[P]:!0,starter_character_form:t.value},{type:'chat'}),await generate({user_input:l}),H.value=!0}catch(e){console.error('[创建角色] 生成失败',e)}finally{G.value=!1}}return(e,P)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',r,[(0,l.createCommentVNode)(' 已提交状态：显示角色摘要 '),(0,l.unref)(H)?((0,l.openBlock)(),(0,l.createElementBlock)('div',n,[P[8]||(P[8]=(0,l.createElementVNode)('div',{class:'summary-header'},[(0,l.createElementVNode)('span',{class:'glitch-icon'},'◈'),(0,l.createElementVNode)('h2',null,'角色已创建'),(0,l.createElementVNode)('span',{class:'glitch-icon'},'◈')],-1)),(0,l.createElementVNode)('div',c,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(ee),(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:a,class:'summary-item'},[(0,l.createElementVNode)('span',s,(0,l.toDisplayString)(a),1),(0,l.createElementVNode)('span',d,(0,l.toDisplayString)(e),1)]))),128))]),P[9]||(P[9]=(0,l.createElementVNode)('p',{class:'summary-hint'},'冒险已开始，请继续对话…',-1))])):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' 表单状态 '),(0,l.createElementVNode)('div',o,[P[19]||(P[19]=(0,l.createStaticVNode)('<div class="form-header" data-v-3abecd67><div class="header-deco" data-v-3abecd67>▸ ▸ ▸</div><h1 class="title" data-v-3abecd67>创建角色</h1><p class="subtitle" data-v-3abecd67>填写你的角色信息，留空部分将由 AI 随机补全</p><div class="header-deco" data-v-3abecd67>◂ ◂ ◂</div></div>',1)),(0,l.createElementVNode)('div',i,[(0,l.createCommentVNode)(' 第一行：姓名 + 年龄 '),(0,l.createElementVNode)('div',u,[(0,l.createElementVNode)('div',m,[P[10]||(P[10]=(0,l.createElementVNode)('label',{class:'field-label'},'姓名',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':P[0]||(P[0]=e=>(0,l.unref)(t).name=e),class:'field-input',type:'text',placeholder:'留空随机生成',disabled:(0,l.unref)(G)},null,8,p),[[l.vModelText,(0,l.unref)(t).name]])]),(0,l.createElementVNode)('div',f,[P[11]||(P[11]=(0,l.createElementVNode)('label',{class:'field-label'},'年龄',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':P[1]||(P[1]=e=>(0,l.unref)(t).age=e),class:'field-input',type:'text',placeholder:'随机',disabled:(0,l.unref)(G)},null,8,v),[[l.vModelText,(0,l.unref)(t).age]])])]),(0,l.createCommentVNode)(' 第二行：性别 + 种族 '),(0,l.createElementVNode)('div',b,[(0,l.createElementVNode)('div',V,[P[12]||(P[12]=(0,l.createElementVNode)('label',{class:'field-label'},'性别',-1)),(0,l.createElementVNode)('div',N,[((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(a,e=>(0,l.createElementVNode)('button',{key:e.value,class:(0,l.normalizeClass)(['gender-btn',{'gender-btn--active':(0,l.unref)(t).gender===e.value}]),disabled:(0,l.unref)(G),onClick:a=>(0,l.unref)(t).gender=e.value},(0,l.toDisplayString)(e.label),11,E)),64))])]),(0,l.createElementVNode)('div',g,[P[13]||(P[13]=(0,l.createElementVNode)('label',{class:'field-label'},'种族',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':P[2]||(P[2]=e=>(0,l.unref)(t).race=e),class:'field-input',type:'text',placeholder:'人类、精灵、兽人… 留空随机',disabled:(0,l.unref)(G)},null,8,h),[[l.vModelText,(0,l.unref)(t).race]])])]),(0,l.createCommentVNode)(' 外貌 '),(0,l.createElementVNode)('div',k,[P[14]||(P[14]=(0,l.createElementVNode)('label',{class:'field-label'},'外貌',-1)),(0,l.withDirectives)((0,l.createElementVNode)('textarea',{'onUpdate:modelValue':P[3]||(P[3]=e=>(0,l.unref)(t).appearance=e),class:'field-textarea',rows:'3',placeholder:'描述角色的外貌特征，留空随机生成',disabled:(0,l.unref)(G)},null,8,y),[[l.vModelText,(0,l.unref)(t).appearance]])]),(0,l.createCommentVNode)(' 特质 '),(0,l.createElementVNode)('div',x,[P[15]||(P[15]=(0,l.createElementVNode)('label',{class:'field-label'},'特质',-1)),(0,l.withDirectives)((0,l.createElementVNode)('textarea',{'onUpdate:modelValue':P[4]||(P[4]=e=>(0,l.unref)(t).traits=e),class:'field-textarea',rows:'3',placeholder:'性格、能力、习惯等特点，留空随机生成',disabled:(0,l.unref)(G)},null,8,w),[[l.vModelText,(0,l.unref)(t).traits]])]),(0,l.createCommentVNode)(' 背景故事 '),(0,l.createElementVNode)('div',B,[P[16]||(P[16]=(0,l.createElementVNode)('label',{class:'field-label'},[(0,l.createTextVNode)('背景故事 '),(0,l.createElementVNode)('span',{class:'field-label--extra'},'（额外设定补充）')],-1)),(0,l.withDirectives)((0,l.createElementVNode)('textarea',{'onUpdate:modelValue':P[5]||(P[5]=e=>(0,l.unref)(t).background=e),class:'field-textarea',rows:'4',placeholder:'角色的来历、经历或额外设定，留空随机生成',disabled:(0,l.unref)(G)},null,8,C),[[l.vModelText,(0,l.unref)(t).background]])])]),(0,l.createCommentVNode)(' 人设库 '),(0,l.createElementVNode)('div',D,[(0,l.createElementVNode)('div',S,[(0,l.withDirectives)((0,l.createElementVNode)('select',{'onUpdate:modelValue':P[6]||(P[6]=e=>(0,l.isRef)(Q)?Q.value=e:null),class:'preset-select',disabled:(0,l.unref)(G)},[P[17]||(P[17]=(0,l.createElementVNode)('option',{value:''},'— 选择已保存设定 —',-1)),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(K),e=>((0,l.openBlock)(),(0,l.createElementBlock)('option',{key:e.name,value:e.name},(0,l.toDisplayString)(e.name),9,T))),128))],8,M),[[l.vModelSelect,(0,l.unref)(Q)]]),(0,l.createElementVNode)('button',{class:'preset-btn',disabled:(0,l.unref)(G)||!(0,l.unref)(Q),onClick:Y},'载入',8,U),(0,l.createElementVNode)('button',{class:'preset-btn preset-btn--danger',disabled:(0,l.unref)(G)||!(0,l.unref)(Q),onClick:Z},'删除',8,I)]),(0,l.createElementVNode)('div',A,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':P[7]||(P[7]=e=>(0,l.isRef)(W)?W.value=e:null),class:'field-input',type:'text',placeholder:'输入设定名称…',disabled:(0,l.unref)(G)},null,8,F),[[l.vModelText,(0,l.unref)(W)]]),(0,l.createElementVNode)('button',{class:'preset-btn preset-btn--save',disabled:(0,l.unref)(G)||!(0,l.unref)(W).trim(),onClick:X},'保存当前设定',8,O)])]),(0,l.createCommentVNode)(' 提交按钮 '),(0,l.createElementVNode)('div',J,[(0,l.createElementVNode)('button',{class:'submit-btn',disabled:(0,l.unref)(G),onClick:ae},[(0,l.unref)(G)?((0,l.openBlock)(),(0,l.createElementBlock)('span',j,[...P[18]||(P[18]=[(0,l.createElementVNode)('span',{class:'spinner'},'⬡',-1),(0,l.createTextVNode)(' 生成中… ',-1)])])):((0,l.openBlock)(),(0,l.createElementBlock)('span',R,' ▶ 开始冒险 '))],8,L)])])],2112))]))}});var H=function e(l){var r=t[l];if(void 0!==r)return r.exports;var n=t[l]={exports:{}};return a[l](n,n.exports,e),n.exports}(667);const K=(0,H.A)(G,[['__scopeId','data-v-3abecd67']]);$(()=>{const a=(0,l.createApp)(K).use(e());a.mount('#app'),$(window).on('pagehide',()=>a.unmount())});
//# sourceMappingURL=index.js.map</script><style>.creator-root[data-v-3abecd67]{--green:#00ff41;--green-dim:#00cc33;--green-glow:rgba(0,255,65,0.35);--bg:#000000;--bg-panel:#080808;--bg-field:#0a0a0a;--border:rgba(0,255,65,0.4);--border-hover:rgba(0,255,65,0.8);--font:'Microsoft YaHei','微软雅黑',sans-serif;--radius:4px;width:100%;background:var(--bg);color:var(--green);font-family:var(--font);font-size:13px;line-height:1.6;padding:16px;box-sizing:border-box}.summary-view[data-v-3abecd67]{display:flex;flex-direction:column;align-items:center;gap:12px}.summary-header[data-v-3abecd67]{display:flex;align-items:center;gap:10px}.summary-header h2[data-v-3abecd67]{font-family:var(--font);font-weight:700;font-size:16px;color:var(--green);margin:0;text-shadow:0 0 8px var(--green-glow)}.summary-header .glitch-icon[data-v-3abecd67]{color:var(--green-dim);font-size:14px}.summary-grid[data-v-3abecd67]{width:100%;display:flex;flex-direction:column;gap:6px;border:1px solid var(--border);border-radius:var(--radius);padding:10px 12px;background:var(--bg-panel)}.summary-item[data-v-3abecd67]{display:flex;gap:12px;font-size:12px}.summary-item .summary-label[data-v-3abecd67]{font-weight:700;color:var(--green);min-width:56px;flex-shrink:0}.summary-item .summary-value[data-v-3abecd67]{color:rgba(0,255,65,.75);word-break:break-word}.summary-hint[data-v-3abecd67]{font-size:11px;color:rgba(0,255,65,.45);margin:0;letter-spacing:.04em}.form-view[data-v-3abecd67]{display:flex;flex-direction:column;gap:14px}.form-header[data-v-3abecd67]{text-align:center;display:flex;flex-direction:column;align-items:center;gap:4px}.form-header .header-deco[data-v-3abecd67]{font-size:10px;color:var(--green-dim);letter-spacing:6px;opacity:.6}.title[data-v-3abecd67]{font-family:var(--font);font-weight:700;font-size:20px;color:var(--green);margin:4px 0;text-shadow:0 0 12px var(--green-glow),0 0 24px rgba(0,255,65,.15);letter-spacing:.12em}.subtitle[data-v-3abecd67]{font-size:11px;color:rgba(0,255,65,.5);margin:0;letter-spacing:.04em}.form-body[data-v-3abecd67]{display:flex;flex-direction:column;gap:10px}.form-row[data-v-3abecd67]{display:flex;gap:10px}.field[data-v-3abecd67]{display:flex;flex-direction:column;gap:4px;flex:1}.field--sm[data-v-3abecd67]{flex:0 0 110px}.field--full[data-v-3abecd67]{width:100%}.field-label[data-v-3abecd67]{font-family:var(--font);font-weight:700;font-size:11px;color:var(--green);text-transform:uppercase;letter-spacing:.08em}.field-label--extra[data-v-3abecd67]{font-weight:400;font-size:10px;color:rgba(0,255,65,.45);text-transform:none;letter-spacing:0}.field-textarea[data-v-3abecd67],.field-input[data-v-3abecd67]{width:100%;background:var(--bg-field);border:1px solid var(--border);border-radius:var(--radius);color:#cfc;font-family:"Consolas","Courier New",monospace;font-size:12px;padding:6px 8px;box-sizing:border-box;outline:none;transition:border-color .15s,box-shadow .15s;resize:none}.field-textarea[data-v-3abecd67]::placeholder,.field-input[data-v-3abecd67]::placeholder{color:rgba(0,255,65,.2)}.field-textarea[data-v-3abecd67]:focus,.field-input[data-v-3abecd67]:focus{border-color:var(--border-hover);box-shadow:0 0 6px var(--green-glow)}.field-textarea[data-v-3abecd67]:disabled,.field-input[data-v-3abecd67]:disabled{opacity:.45;cursor:not-allowed}.field-textarea[data-v-3abecd67]{line-height:1.5}.gender-group[data-v-3abecd67]{display:flex;gap:5px}.gender-btn[data-v-3abecd67]{flex:1;padding:5px 4px;background:rgba(0,0,0,0);border:1px solid var(--border);border-radius:var(--radius);color:rgba(0,255,65,.55);font-family:var(--font);font-weight:700;font-size:11px;cursor:pointer;transition:all .15s}.gender-btn[data-v-3abecd67]:hover:not(:disabled){border-color:var(--green);color:var(--green);background:rgba(0,255,65,.07)}.gender-btn--active[data-v-3abecd67]{border-color:var(--green) !important;background:rgba(0,255,65,.15) !important;color:var(--green) !important;box-shadow:0 0 6px var(--green-glow)}.gender-btn[data-v-3abecd67]:disabled{opacity:.4;cursor:not-allowed}.preset-section[data-v-3abecd67]{display:flex;flex-direction:column;gap:6px;border:1px solid var(--border);border-radius:var(--radius);padding:8px 10px;background:var(--bg-panel)}.preset-row[data-v-3abecd67]{display:flex;gap:6px;align-items:center}.preset-select[data-v-3abecd67]{flex:1;background:var(--bg-field);border:1px solid var(--border);border-radius:var(--radius);color:#cfc;font-family:"Consolas","Courier New",monospace;font-size:12px;padding:5px 8px;outline:none;cursor:pointer;transition:border-color .15s}.preset-select[data-v-3abecd67]:focus{border-color:var(--border-hover);box-shadow:0 0 6px var(--green-glow)}.preset-select option[data-v-3abecd67]{background:#0a0a0a;color:#cfc}.preset-select[data-v-3abecd67]:disabled{opacity:.45;cursor:not-allowed}.preset-btn[data-v-3abecd67]{flex-shrink:0;padding:5px 10px;background:rgba(0,0,0,0);border:1px solid var(--border);border-radius:var(--radius);color:rgba(0,255,65,.7);font-family:var(--font);font-weight:700;font-size:11px;cursor:pointer;transition:all .15s;white-space:nowrap}.preset-btn[data-v-3abecd67]:hover:not(:disabled){border-color:var(--green);color:var(--green);background:rgba(0,255,65,.07)}.preset-btn[data-v-3abecd67]:disabled{opacity:.35;cursor:not-allowed}.preset-btn--save[data-v-3abecd67]{border-color:rgba(0,255,65,.6);color:var(--green)}.preset-btn--save[data-v-3abecd67]:hover:not(:disabled){background:rgba(0,255,65,.12);box-shadow:0 0 6px var(--green-glow)}.preset-btn--danger[data-v-3abecd67]{border-color:rgba(255,60,60,.4);color:rgba(255,100,100,.7)}.preset-btn--danger[data-v-3abecd67]:hover:not(:disabled){border-color:rgba(255,60,60,.8);color:#ff6464;background:rgba(255,60,60,.08)}.form-footer[data-v-3abecd67]{display:flex;justify-content:center;padding-top:4px}.submit-btn[data-v-3abecd67]{display:inline-flex;align-items:center;justify-content:center;min-width:160px;padding:10px 28px;background:var(--green);border:none;border-radius:var(--radius);color:#000;font-family:var(--font);font-weight:700;font-size:14px;letter-spacing:.1em;cursor:pointer;transition:all .2s;box-shadow:0 0 14px var(--green-glow)}.submit-btn[data-v-3abecd67]:hover:not(:disabled){background:#3f6;box-shadow:0 0 22px rgba(0,255,65,.6);transform:translateY(-1px)}.submit-btn[data-v-3abecd67]:active:not(:disabled){transform:translateY(0)}.submit-btn[data-v-3abecd67]:disabled{opacity:.55;cursor:not-allowed;box-shadow:none}.btn-inner[data-v-3abecd67]{display:flex;align-items:center;gap:6px}.spinner[data-v-3abecd67]{display:inline-block;animation:spin-3abecd67 1s linear infinite}@keyframes spin-3abecd67{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}

/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>